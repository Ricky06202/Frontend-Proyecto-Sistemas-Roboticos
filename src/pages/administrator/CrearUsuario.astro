--- 
import StudentLayout from '@attendance/layouts/StudentLayout.astro'
---

<StudentLayout title='Crear Usuario'>
    <div class="min-h-screen bg-gradient-to-br from-indigo-50 to-purple-50 py-12">
        <div class="container mx-auto px-4 max-w-4xl">
            <!-- Encabezado con efecto de gradiente -->
            <div class="mb-10 text-center">
                <h1 class="text-5xl font-extrabold text-transparent bg-clip-text bg-gradient-to-r from-purple-600 to-indigo-600 mb-3">
                    Gestión de Usuarios
                </h1>
                <p class="text-gray-600 text-xl">Crear nuevo usuario en el sistema</p>
            </div>

            <!-- Card principal con efecto de cristal -->
            <div class="backdrop-blur-lg bg-white/80 rounded-2xl shadow-2xl p-8 border border-white/20">
                <form class="space-y-8" id="usuarioForm">
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
                        <!-- Nombre -->
                        <div class="space-y-2">
                            <label for="nombre" class="block text-sm font-bold text-gray-700 uppercase tracking-wide">
                                Nombre Completo
                            </label>
                            <input 
                                type="text" 
                                id="nombre" 
                                name="nombre" 
                                class="w-full px-5 py-3 border-2 border-gray-200 rounded-xl focus:ring-4 focus:ring-indigo-200 focus:border-indigo-600 outline-none transition-all duration-300 bg-white/50 backdrop-blur-sm"
                                placeholder="Ej: Juan Pérez"
                                required
                            />
                        </div>

                        <!-- Email -->
                        <div class="space-y-2">
                            <label for="email" class="block text-sm font-bold text-gray-700 uppercase tracking-wide">
                                Correo Electrónico
                            </label>
                            <input 
                                type="email" 
                                id="email" 
                                name="email" 
                                class="w-full px-5 py-3 border-2 border-gray-200 rounded-xl focus:ring-4 focus:ring-indigo-200 focus:border-indigo-600 outline-none transition-all duration-300 bg-white/50 backdrop-blur-sm"
                                placeholder="ejemplo@dominio.com"
                                required
                            />
                        </div>
                    </div>

                    <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
                        <!-- Contraseña -->
                        <div class="space-y-2">
                            <label for="password" class="block text-sm font-bold text-gray-700 uppercase tracking-wide">
                                Contraseña
                            </label>
                            <input 
                                type="password" 
                                id="password" 
                                name="password" 
                                class="w-full px-5 py-3 border-2 border-gray-200 rounded-xl focus:ring-4 focus:ring-indigo-200 focus:border-indigo-600 outline-none transition-all duration-300 bg-white/50 backdrop-blur-sm"
                                required
                            />
                        </div>

                        <!-- Rol -->
                        <div class="space-y-2">
                            <label for="rol" class="block text-sm font-bold text-gray-700 uppercase tracking-wide">
                                Rol de Usuario
                            </label>
                            <select 
                                id="rol" 
                                name="rol" 
                                class="w-full px-5 py-3 border-2 border-gray-200 rounded-xl focus:ring-4 focus:ring-indigo-200 focus:border-indigo-600 outline-none transition-all duration-300 bg-white/50 backdrop-blur-sm"
                                required
                            >
                                <option value="">Seleccionar rol</option>
                                <option value="estudiante">Estudiante</option>
                                <option value="profesor">Profesor</option>
                                <option value="administrador">Administrador</option>
                            </select>
                        </div>
                    </div>

                    <!-- Botón de submit -->
                    <div class="flex justify-end pt-6 relative z-10">
                        <button
                            type="submit"
                            class="w-full md:w-auto bg-sky-400 hover:bg-sky-500 text-white px-6 py-3 rounded-lg 
                                   transition-all duration-300 transform hover:scale-105 flex items-center justify-center gap-2"
                        >
                            <svg xmlns="http://www.w3.org/2000/svg" 
                                 class="h-5 w-5" 
                                 viewBox="0 0 20 20" 
                                 fill="currentColor">
                                <path fill-rule="evenodd" 
                                      d="M10 3a1 1 0 011 1v5h5a1 1 0 110 2h-5v5a1 1 0 11-2 0v-5H4a1 1 0 110-2h5V4a1 1 0 011-1z" 
                                      clip-rule="evenodd" />
                            </svg>
                            Crear Usuario
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Notificación -->
    <div id="notification" class="fixed bottom-4 right-4 hidden">
        <div class="bg-gradient-to-r from-green-500 to-emerald-500 text-white px-8 py-5 rounded-xl shadow-2xl transform transition-all duration-300">
            <p class="flex items-center text-lg font-semibold">
                <svg class="w-7 h-7 mr-3" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
                </svg>
                <span id="notificationMessage"></span>
            </p>
        </div>
    </div>
</StudentLayout>

<script>
    const form = document.getElementById('usuarioForm');
    const notification = document.getElementById('notification');
    const notificationMessage = document.getElementById('notificationMessage');
    
    const showNotification = (message: string, type: 'success' | 'error' = 'success') => {
        if (notification && notificationMessage) {
            notificationMessage.textContent = message;
            notification.classList.remove('hidden');
            notification.classList.add('animate-fade-in');
            
            if (type === 'error') {
                notification.firstElementChild?.classList.remove('bg-green-500');
                notification.firstElementChild?.classList.add('bg-red-500');
            } else {
                notification.firstElementChild?.classList.remove('bg-red-500');
                notification.firstElementChild?.classList.add('bg-green-500');
            }

            setTimeout(() => {
                notification.classList.add('hidden');
            }, 3000);
        }
    };

    form?.addEventListener('submit', async (e) => {
        e.preventDefault();
        const formData = new FormData(e.target as HTMLFormElement);
        const data = Object.fromEntries(formData);
        
        try {
            console.log('Datos del usuario:', data);
            showNotification('Usuario creado exitosamente');
            (e.target as HTMLFormElement).reset();
        } catch (error) {
            console.error('Error al crear el usuario:', error);
            showNotification('Error al crear el usuario', 'error');
        }
    });
</script>

<style>
    /* Animación de entrada para el título */
    h1 {
        animation: slideDown 0.8s ease-out;
    }

    /* Animación para la card principal */
    .backdrop-blur-lg {
        animation: fadeScale 0.6s ease-out;
    }

    /* Animaciones para los inputs */
    input, textarea, select {
        animation: slideRight 0.5s ease-out backwards;
    }

    /* Animación personalizada para cada input con delay */
    #nombre {
        animation-delay: 0.2s;
    }

    #email {
        animation-delay: 0.3s;
    }

    #password {
        animation-delay: 0.4s;
    }

    #rol {
        animation-delay: 0.5s;
    }

    /* Animación para el botón */
    button[type="submit"] {
        animation: bounceIn 0.8s cubic-bezier(0.68, -0.55, 0.265, 1.55) backwards;
        animation-delay: 0.6s;
    }

    /* Definición de las animaciones */
    @keyframes slideDown {
        from {
            opacity: 0;
            transform: translateY(-30px);
        }
        to {
            opacity: 1;
            transform: translateY(0);
        }
    }

    @keyframes fadeScale {
        from {
            opacity: 0;
            transform: scale(0.95);
        }
        to {
            opacity: 1;
            transform: scale(1);
        }
    }

    @keyframes slideRight {
        from {
            opacity: 0;
            transform: translateX(-20px);
        }
        to {
            opacity: 1;
            transform: translateX(0);
        }
    }

    @keyframes bounceIn {
        0% {
            opacity: 0;
            transform: scale(0.3);
        }
        50% {
            opacity: 0.9;
            transform: scale(1.1);
        }
        80% {
            opacity: 1;
            transform: scale(0.89);
        }
        100% {
            opacity: 1;
            transform: scale(1);
        }
    }

    /* Animaciones para hover en inputs */
    input:hover, textarea:hover, select:hover {
        transform: translateY(-2px);
        transition: transform 0.3s ease;
    }

    /* Animación para el fondo */
    .bg-gradient-to-br {
        background-size: 400% 400%;
        animation: gradientBG 15s ease infinite;
    }

    @keyframes gradientBG {
        0% {
            background-position: 0% 50%;
        }
        50% {
            background-position: 100% 50%;
        }
        100% {
            background-position: 0% 50%;
        }
    }

    /* Animación mejorada para la notificación */
    .animate-fade-in {
        animation: notificationSlide 0.5s cubic-bezier(0.68, -0.55, 0.265, 1.55);
    }

    @keyframes notificationSlide {
        from {
            opacity: 0;
            transform: translateX(100px) translateY(2rem);
        }
        to {
            opacity: 1;
            transform: translateX(0) translateY(0);
        }
    }
</style>
